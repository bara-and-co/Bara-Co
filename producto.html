<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Producto · Bara & Co</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
  <link rel="stylesheet" href="css/global.css"/>
  <style>
    /* (Copiar los mismos estilos de tienda.html para mantener consistencia) */
    :root {
      --bg:      #0e0e0c;
      --surface: #161614;
      --border:  rgba(255,255,255,.07);
      --text:    #f0ece4;
      --muted:   #7a7872;
      --accent:  #c9a96e;
      --adk:     #9e7a3e;
      --red:     #b83030;
      --white:   #fff;
      --serif:   'Playfair Display', serif;
      --sans:    'Inter', sans-serif;
      --ease:    cubic-bezier(.16,1,.3,1);
    }
    
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      background:var(--bg); color:var(--text);
      font-family:var(--sans); font-size:15px; line-height:1.6;
      padding-top:72px;
    }
    
    /* Header - mismo que tienda.html */
    #header {
      position:fixed; top:0; left:0; right:0; z-index:200;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 48px; height:72px;
      background:rgba(14,14,12,.93); backdrop-filter:blur(20px);
      border-bottom:1px solid var(--border);
    }
    
    /* Breadcrumb */
    .breadcrumb {
      padding:24px 48px 0;
      font-size:12px; color:var(--muted);
    }
    .breadcrumb a { color:var(--muted); }
    .breadcrumb a:hover { color:var(--accent); }
    
    /* Página de producto */
    .product-page {
      display:grid; grid-template-columns:1fr 1fr;
      gap:40px; padding:40px 48px 80px;
      max-width:1400px; margin:0 auto;
    }
    
    /* Galería */
    .gallery {
      position:sticky; top:100px;
    }
    .main-image {
      aspect-ratio:3/4; overflow:hidden; border:1px solid var(--border);
      margin-bottom:16px;
    }
    .main-image img {
      width:100%; height:100%; object-fit:cover;
      transition:transform .3s;
    }
    .thumbnails {
      display:flex; gap:8px; overflow-x:auto; padding-bottom:8px;
    }
    .thumb {
      width:80px; height:100px; flex-shrink:0;
      border:1px solid var(--border); cursor:pointer;
      transition:border-color .2s;
    }
    .thumb:hover { border-color:var(--accent); }
    .thumb img { width:100%; height:100%; object-fit:cover; }
    
    /* Info producto */
    .product-info { padding:20px 0; }
    .product-category {
      font-size:10px; letter-spacing:.2em; text-transform:uppercase;
      color:var(--accent); margin-bottom:10px;
    }
    .product-title {
      font-family:var(--serif); font-size:42px; font-weight:400;
      margin-bottom:20px; line-height:1.1;
    }
    .product-price {
      font-size:32px; color:var(--accent); margin-bottom:20px;
    }
    .product-price del {
      font-size:20px; color:var(--muted); margin-right:10px;
    }
    .product-description {
      font-size:15px; color:var(--muted); line-height:1.8;
      margin-bottom:30px; padding-bottom:30px;
      border-bottom:1px solid var(--border);
    }
    
    /* Selector de talle */
    .size-label {
      font-size:12px; font-weight:600; letter-spacing:.1em;
      text-transform:uppercase; margin-bottom:12px;
    }
    .size-guide-link {
      float:right; font-size:11px; color:var(--accent);
      text-decoration:underline; cursor:pointer;
    }
    .size-options {
      display:flex; flex-wrap:wrap; gap:8px; margin-bottom:24px;
    }
    .size-btn {
      min-width:52px; padding:12px 18px;
      border:1px solid var(--border); background:none;
      color:var(--text); font-size:14px; cursor:pointer;
      transition:all .2s;
    }
    .size-btn:hover { border-color:var(--accent); }
    .size-btn.active {
      background:var(--accent); border-color:var(--accent); color:var(--bg);
    }
    .size-btn.out-of-stock {
      opacity:.3; cursor:not-allowed; text-decoration:line-through;
    }
    
    /* Selector de color */
    .color-options {
      display:flex; gap:10px; margin-bottom:30px;
    }
    .color-btn {
      width:36px; height:36px; border-radius:50%;
      border:2px solid transparent; cursor:pointer;
      transition:border-color .2s;
    }
    .color-btn:hover, .color-btn.active { border-color:var(--accent); }
    
    /* Botones de acción */
    .action-buttons {
      display:flex; gap:12px; margin-bottom:30px;
    }
    .btn {
      flex:1; padding:15px; border:none; cursor:pointer;
      font-family:var(--sans); font-size:12px; font-weight:600;
      letter-spacing:.15em; text-transform:uppercase;
      display:flex; align-items:center; justify-content:center; gap:8px;
      transition:all .2s;
    }
    .btn-primary {
      background:var(--accent); color:var(--bg);
    }
    .btn-primary:hover { background:var(--adk); }
    .btn-secondary {
      background:transparent; border:1px solid var(--border); color:var(--text);
    }
    .btn-secondary:hover { border-color:var(--accent); color:var(--accent); }
    
    /* Stock y envíos */
    .stock-info {
      display:flex; gap:24px; margin-bottom:30px;
      padding:20px; background:var(--surface); border:1px solid var(--border);
    }
    .stock-item {
      display:flex; align-items:center; gap:8px; font-size:13px;
    }
    .stock-item i { color:var(--accent); }
    
    /* Productos relacionados */
    .related {
      grid-column:1/-1;
      padding:60px 0 0;
      border-top:1px solid var(--border);
    }
    .related h3 {
      font-family:var(--serif); font-size:28px; font-weight:400;
      margin-bottom:30px;
    }
    .related-grid {
      display:grid; grid-template-columns:repeat(4,1fr); gap:2px;
    }
    .related-card {
      background:var(--surface); cursor:pointer;
    }
    .related-card img {
      aspect-ratio:3/4; object-fit:cover; width:100%;
    }
    
    @media (max-width:900px) {
      .product-page { grid-template-columns:1fr; padding:20px; }
      .gallery { position:static; }
      .related-grid { grid-template-columns:repeat(2,1fr); }
    }
  </style>
</head>
<body>

<header id="header">
  <a href="index.html"><img src="images/logo.png" alt="Bara & Co" style="height:52px;"/></a>
  <nav class="header-nav">
    <ul>
      <li><a href="index.html">Inicio</a></li>
      <li><a href="tienda.html" class="active">Tienda</a></li>
      <li><a href="lookbook.html">Lookbook</a></li>
      <li><a href="contacto.html">Contacto</a></li>
    </ul>
  </nav>
  <div class="header-icons">
    <i class="fas fa-search"></i>
    <div class="cart-icon-wrap" onclick="toggleCart()">
      <i class="fas fa-shopping-bag"></i>
      <span class="cart-badge" id="cartBadge">0</span>
    </div>
  </div>
</header>

<!-- Breadcrumb -->
<div class="breadcrumb">
  <a href="index.html">Inicio</a> / <a href="tienda.html">Tienda</a> / <span id="breadcrumbCat">Categoría</span> / <span id="breadcrumbName">Producto</span>
</div>

<!-- Página de producto -->
<div class="product-page">
  <!-- Galería -->
  <div class="gallery">
    <div class="main-image" id="mainImage">
      <img src="" alt="" id="currentImage"/>
    </div>
    <div class="thumbnails" id="thumbnails"></div>
  </div>
  
  <!-- Info producto -->
  <div class="product-info">
    <p class="product-category" id="productCategory"></p>
    <h1 class="product-title" id="productName"></h1>
    <div class="product-price" id="productPrice"></div>
    <p class="product-description" id="productDescription">Prenda de alta calidad, diseño exclusivo Bara & Co. Consultá disponibilidad de talles.</p>
    
    <!-- Selector de talle -->
    <div class="size-label">
      TALLE
      <span class="size-guide-link" onclick="openSizeGuide()">Guía de talles</span>
    </div>
    <div class="size-options" id="sizeOptions"></div>
    
    <!-- Selector de color (opcional) -->
    <div class="size-label">COLOR</div>
    <div class="color-options" id="colorOptions"></div>
    
    <!-- Botones -->
    <div class="action-buttons">
      <button class="btn btn-primary" id="addToCartBtn">
        <i class="fas fa-shopping-bag"></i> AGREGAR AL CARRITO
      </button>
      <button class="btn btn-secondary" id="whatsappBtn">
        <i class="fab fa-whatsapp"></i> CONSULTAR
      </button>
    </div>
    
    <!-- Stock info -->
    <div class="stock-info">
      <div class="stock-item"><i class="fas fa-truck"></i> Envío gratis +$80.000</div>
      <div class="stock-item"><i class="fas fa-undo-alt"></i> Cambios y devoluciones</div>
      <div class="stock-item"><i class="fas fa-shield-alt"></i> Compra segura</div>
    </div>
  </div>
  
  <!-- Productos relacionados -->
  <div class="related">
    <h3>También te puede gustar</h3>
    <div class="related-grid" id="relatedProducts"></div>
  </div>
</div>

<!-- Guía de talles modal -->
<div class="qv-backdrop" id="sgBackdrop" onclick="closeSizeGuide()"></div>
<div class="sg-modal" id="sgModal">
  <button class="sg-close" onclick="closeSizeGuide()">×</button>
  <h2>Guía de Talles</h2>
  <p style="font-size:13px;color:var(--muted);margin-bottom:20px;">Medite el contorno de pecho, cintura y cadera para elegir el talle correcto.</p>
  <h4 style="font-size:11px;letter-spacing:.15em;text-transform:uppercase;color:var(--muted);margin-bottom:12px;">Ropa Hombre</h4>
  <table class="sg-table">
    <thead><tr><th>Talle</th><th>Pecho (cm)</th><th>Cintura (cm)</th><th>Cadera (cm)</th></tr></thead>
    <tbody>
      <tr><td>S</td><td>88–92</td><td>74–78</td><td>88–92</td></tr>
      <tr><td>M</td><td>93–98</td><td>79–84</td><td>93–98</td></tr>
      <tr><td>L</td><td>99–104</td><td>85–90</td><td>99–104</td></tr>
      <tr><td>XL</td><td>105–112</td><td>91–98</td><td>105–112</td></tr>
    </tbody>
  </table>
  <h4 style="font-size:11px;letter-spacing:.15em;text-transform:uppercase;color:var(--muted);margin-bottom:12px;">Ropa Mujer</h4>
  <table class="sg-table">
    <thead><tr><th>Talle</th><th>Pecho (cm)</th><th>Cintura (cm)</th><th>Cadera (cm)</th></tr></thead>
    <tbody>
      <tr><td>XS</td><td>80–84</td><td>62–66</td><td>84–88</td></tr>
      <tr><td>S</td><td>85–88</td><td>67–70</td><td>89–92</td></tr>
      <tr><td>M</td><td>89–93</td><td>71–75</td><td>93–97</td></tr>
      <tr><td>L</td><td>94–99</td><td>76–81</td><td>98–103</td></tr>
    </tbody>
  </table>
</div>

<!-- Carrito drawer (igual que en tienda) -->
<div class="cart-backdrop" id="cartBackdrop" onclick="toggleCart()"></div>
<div class="cart-drawer" id="cartDrawer">
  <!-- ... mismo contenido que en tienda.html ... -->
  <div class="cd-head">
    <h2 class="cd-title">Carrito</h2>
    <button class="cd-close" onclick="toggleCart()">×</button>
  </div>
  <div class="cd-body" id="cdBody">
    <div class="cd-empty">Tu carrito está vacío</div>
  </div>
  <div class="cd-foot">
    <div class="cd-subtotal"><span>Subtotal</span><span id="cdTotal">$0</span></div>
    <button class="pay-btn pay-mp" onclick="pagarMP()">Pagar con MercadoPago</button>
    <button class="pay-btn pay-wa" onclick="pagarWA()">Solicitar por WhatsApp</button>
  </div>
</div>

<script>
// ========== CARGA DE DATOS DEL PRODUCTO ==========
let currentProduct = null;
let selectedSize = null;
let selectedColor = null;
let cart = JSON.parse(localStorage.getItem('bc_cart') || '[]');

// Obtener ID del producto de la URL (?id=nombre-del-producto)
const urlParams = new URLSearchParams(window.location.search);
const productId = urlParams.get('id') || 'campera-jean-clasica';

// Base de datos de productos (simulada - después podemos cargar desde JSON)
const productDatabase = {
  'campera-jean-clasica': {
    id: 'campera-jean-clasica',
    name: 'Campera JEAN clásica',
    price: 75000,
    oldPrice: null,
    category: 'new hombre',
    categoryLabel: 'New Collection · Hombre',
    description: 'Campera de jean clásica, corte recto, lavado medio. Ideal para looks urbanos. Composición: 98% algodón, 2% elastano.',
    images: [
      'https://d22fxaf9t8d39k.cloudfront.net/d96714644466596d09ed9ffb84226e2b318859a866be9604788cf4154aa52650404368.jpg',
      'https://d22fxaf9t8d39k.cloudfront.net/d96714644466596d09ed9ffb84226e2b318859a866be9604788cf4154aa52650404368.jpg'
    ],
    sizes: ['S', 'M', 'L', 'XL'],
    colors: ['Azul', 'Negro'],
    colorCodes: ['#0066cc', '#000000']
  },
  'sastrero-rialto': {
    id: 'sastrero-rialto',
    name: 'Sastrero RIALTO',
    price: 70000,
    oldPrice: null,
    category: 'new hombre',
    categoryLabel: 'New Collection · Hombre',
    description: 'Sastrero de lino, corte moderno, ideal para ocasiones especiales o looks elegantes.',
    images: ['https://d22fxaf9t8d39k.cloudfront.net/82f0a5682cfeff36ae17af15cd408edaedc84e200eed095f5d3ac7d84b92d4ab404368.jpg'],
    sizes: ['S', 'M', 'L'],
    colors: ['Beige', 'Gris'],
    colorCodes: ['#f5f5dc', '#808080']
  },
  'abanico-orgullo': {
    id: 'abanico-orgullo',
    name: 'Abanico ORGULLO',
    price: 20000,
    oldPrice: null,
    category: 'accesorios',
    categoryLabel: 'Accesorios · Abanicos',
    description: 'Abanico plegable con diseño exclusivo ORGULLO. Ideal para el verano.',
    images: ['https://d22fxaf9t8d39k.cloudfront.net/d7bb9acf8f5ca09e741eac41c71f65a1a789da46d32346dbcc8da085b6888a8b404368.jpg'],
    sizes: ['Único'],
    colors: ['Multicolor'],
    colorCodes: ['#ff69b4']
  }
};

// Cargar producto
function loadProduct() {
  const product = productDatabase[productId];
  if (!product) {
    window.location.href = 'tienda.html';
    return;
  }
  
  currentProduct = product;
  
  // Actualizar breadcrumb
  document.getElementById('breadcrumbCat').textContent = product.categoryLabel.split('·')[0].trim();
  document.getElementById('breadcrumbName').textContent = product.name;
  
  // Imagen principal
  document.getElementById('currentImage').src = product.images[0];
  document.getElementById('currentImage').alt = product.name;
  
  // Thumbnails
  const thumbs = document.getElementById('thumbnails');
  thumbs.innerHTML = '';
  product.images.forEach((img, index) => {
    const thumb = document.createElement('div');
    thumb.className = 'thumb';
    thumb.innerHTML = `<img src="${img}" alt="${product.name}" onclick="changeImage(${index})">`;
    thumbs.appendChild(thumb);
  });
  
  // Info
  document.getElementById('productCategory').textContent = product.categoryLabel;
  document.getElementById('productName').textContent = product.name;
  
  const priceEl = document.getElementById('productPrice');
  if (product.oldPrice) {
    priceEl.innerHTML = `<del>$${product.oldPrice.toLocaleString('es-AR')}</del> $${product.price.toLocaleString('es-AR')}`;
  } else {
    priceEl.textContent = '$' + product.price.toLocaleString('es-AR');
  }
  
  document.getElementById('productDescription').textContent = product.description;
  
  // Talles
  const sizeOptions = document.getElementById('sizeOptions');
  sizeOptions.innerHTML = '';
  product.sizes.forEach(size => {
    const btn = document.createElement('button');
    btn.className = 'size-btn';
    btn.textContent = size;
    btn.onclick = () => selectSize(size, btn);
    sizeOptions.appendChild(btn);
  });
  
  // Colores
  if (product.colors && product.colors.length > 0) {
    const colorOptions = document.getElementById('colorOptions');
    colorOptions.innerHTML = '';
    product.colors.forEach((color, index) => {
      const btn = document.createElement('button');
      btn.className = 'color-btn';
      btn.style.backgroundColor = product.colorCodes[index] || '#ccc';
      btn.title = color;
      btn.onclick = () => selectColor(color, btn);
      colorOptions.appendChild(btn);
    });
  }
  
  // Productos relacionados (simulados)
  loadRelatedProducts(product.category);
}

function changeImage(index) {
  document.getElementById('currentImage').src = currentProduct.images[index];
}

function selectSize(size, btn) {
  document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  selectedSize = size;
}

function selectColor(color, btn) {
  document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  selectedColor = color;
}

function loadRelatedProducts(category) {
  const related = document.getElementById('relatedProducts');
  const cat = category.split(' ')[0]; // 'new' o 'hombre' etc
  
  const relatedItems = Object.values(productDatabase)
    .filter(p => p.category.includes(cat) && p.id !== productId)
    .slice(0, 4);
  
  related.innerHTML = '';
  relatedItems.forEach(p => {
    const card = document.createElement('div');
    card.className = 'related-card';
    card.onclick = () => window.location.href = `producto.html?id=${p.id}`;
    card.innerHTML = `
      <img src="${p.images[0]}" alt="${p.name}"/>
      <div style="padding:12px;">
        <div style="font-size:13px;">${p.name}</div>
        <div style="color:var(--accent);">$${p.price.toLocaleString('es-AR')}</div>
      </div>
    `;
    related.appendChild(card);
  });
}

// ========== CARRITO ==========
function saveCart() { localStorage.setItem('bc_cart', JSON.stringify(cart)); renderCart(); }

function toggleCart() {
  document.getElementById('cartDrawer').classList.toggle('open');
  document.getElementById('cartBackdrop').classList.toggle('open');
}

function addToCart() {
  if (!selectedSize) {
    alert('Por favor seleccioná un talle');
    return;
  }
  
  const item = {
    id: currentProduct.id,
    name: currentProduct.name,
    price: currentProduct.price,
    size: selectedSize,
    color: selectedColor || null,
    img: currentProduct.images[0],
    qty: 1
  };
  
  const found = cart.find(i => i.id === item.id && i.size === item.size);
  if (found) found.qty++;
  else cart.push(item);
  
  saveCart();
  toggleCart();
  showToast();
}

function showToast() {
  const t = document.getElementById('cartToast');
  if (!t) {
    const toast = document.createElement('div');
    toast.className = 'cart-toast';
    toast.id = 'cartToast';
    toast.innerHTML = '<i class="fas fa-check-circle"></i> Producto agregado al carrito';
    document.body.appendChild(toast);
    setTimeout(() => {
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2400);
    }, 10);
  } else {
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 2400);
  }
}

function renderCart() {
  const badge = document.getElementById('cartBadge');
  const total = document.getElementById('cdTotal');
  const cnt = cart.reduce((s,i) => s+i.qty, 0);
  const sum = cart.reduce((s,i) => s+i.price*i.qty, 0);
  badge.textContent = cnt;
  badge.classList.toggle('on', cnt > 0);
  total.textContent = '$' + sum.toLocaleString('es-AR');
}

function pagarWA() {
  if (!cart.length) return;
  const lines = cart.map(i => `• ${i.name} (Talle ${i.size})${i.qty>1?' x'+i.qty:''} — $${(i.price*i.qty).toLocaleString('es-AR')}`).join('%0A');
  const total = cart.reduce((s,i) => s+i.price*i.qty, 0);
  window.open(`https://wa.me/5493525614281?text=Hola!%20Quiero%20hacer%20el%20siguiente%20pedido:%0A${lines}%0A%0ATotal:%20$${total.toLocaleString('es-AR')}`, '_blank');
}

function pagarMP() {
  if (!cart.length) return;
  const total = cart.reduce((s,i) => s+i.price*i.qty, 0);
  window.open(`https://link.mercadopago.com.ar/baraandco?amount=${total}`, '_blank');
}

// ========== GUÍA DE TALLES ==========
function openSizeGuide() {
  document.getElementById('sgModal').classList.add('open');
  document.getElementById('sgBackdrop').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeSizeGuide() {
  document.getElementById('sgModal').classList.remove('open');
  document.getElementById('sgBackdrop').classList.remove('open');
  document.body.style.overflow = '';
}

// ========== INICIALIZACIÓN ==========
document.addEventListener('DOMContentLoaded', () => {
  loadProduct();
  renderCart();
  
  document.getElementById('addToCartBtn').addEventListener('click', addToCart);
  document.getElementById('whatsappBtn').addEventListener('click', () => {
    const msg = `Hola! Quiero consultar por *${currentProduct?.name}*`;
    window.open(`https://wa.me/5493525614281?text=${encodeURIComponent(msg)}`, '_blank');
  });
});
</script>

<!-- Toast -->
<div class="cart-toast" id="cartToast" style="position:fixed;bottom:28px;left:50%;transform:translateX(-50%) translateY(60px);background:var(--surface);border:1px solid var(--accent);color:var(--text);padding:12px 22px;z-index:700;opacity:0;transition:all .4s;"><i class="fas fa-check-circle"></i> Producto agregado al carrito</div>

</body>
</html>
